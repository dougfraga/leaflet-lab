<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Previsão de Correntes [BIG-BS]</title>

    <meta name="description" content="Página de apresentação da previsão operacional das correntes nas baías de Ilha Grande e Sepetiba">
    <meta name="author" content="Douglas Fraga Rodrigues">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel='icon' href="images/visual/favicon.png" type='image/x-icon' sizes="16x16" />
	<!--LEAFLET CODE-->
	<link rel="stylesheet" href="src/leaflet.css">
	<link rel="stylesheet" href="src/css/bootstrap.css">
	<link rel="stylesheet" href="src/plugins/L.Control.MousePosition.css">
	
	<script src="src/leaflet-src.js"></script>
	<script src="src/jquery-3.6.1.min.js"></script>
	<script src="src/plugins/L.Control.MousePosition.js"></script>

    <style>
        #main {
            height: 100vh;
        }
    </style>

  </head>
  <body>

    <div class="container-fluid p-0"  id="main">
    	<div class="row py-0 px-5 m-0 bg-light">
			<ul class="list-inline">
				<li class="list-inline-item">
					 <a class="nav-link" href="https://douglasfraga.com/"><img src="images/visual/logo.png" class="w-50"></a>
				</li>
				<li class="list-inline-item ms-auto">
					 <a class="nav-link" href="https://douglasfraga.com/"><span class="sr-only">Home</span></a>
				</li>
			</ul>
		</div>
		<div class="row m-0 px-5">
			<div id="mapdiv" class="col-md-7 col-sm-12 pt-5"></div>

			<div class="col-md-5 col-sm-12">
				<h2 class="px-4 pt-4">
					Previsão de correntes
				</h2>
				<h3 class="p-4">
					Baías de Ilha Grande e Sepetiba
				</h3>
				<p class="px-4 pt-3 mr-5">
					A simulações são conduzidas com o
					<a href="http://www.mohid.com/" target="blank">MOHID  Water Modelling System</a>, em uma
					configuração tridimensional com 10 camadas sigma e forçamentos dos campos de velocidade,
					temperatura, salinidade e elevação da superfície do mar obtidos a partir do modelo global
					<a href="https://marine.copernicus.eu/" target="blank">Mercator</a>.
					Os processos astronômicos são incluídos no modelo a partir do modelo
					<a href="https://www.aviso.altimetry.fr/en/data/products/auxiliary-products/global-tide-fes/description-fes2012.html" target="blank">FES2012</a>.
				</p>
				<p class="px-4 mr-5">
					As previsões operacionais das correntes são atualizadas diariamente.
				</p>
			</div>


		</div>
		<div class="row m-0 bg-dark py-4 px-5 mt-5">
			<p class="px-4 mr-5 text-light">
				Em caso de dúvidas ou sugestões, fique à vontade para entrar em <a href="https://api.whatsapp.com/send?phone=5521969268787" target="blank">contato</a>.
			</p>
		</div>
	</div>

  	<script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/scripts.js"></script>

	<script>
		var mymap;
		var lyrOSM;
		var mrkCurrentLocation;
		var popBig;
		var ctlZoom;
		var ctlCoords;
		var ctlScale;
		var ctlMousePos;
		
		$(document).ready(function(){
			mymap = L.map('mapdiv', {center:[-23.1, -44.2], zoom:10,
						zoomControl:false, attributionControl:false});
			lyrOSM = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png');
			mymap.addLayer(lyrOSM);
			
			ctlZoom = L.control.zoom({zoomInText:'+', zoomOutText:'-', position:'topright'});
			ctlZoom.addTo(mymap);
			
			ctlCoords = L.control.attribution({position:'bottomright'}).addTo(mymap);
			ctlCoords.addAttribution('<a href="https://douglasfraga.com/" target="blank">Douglas Fraga</a>');
			
			ctlScale = L.control.scale({position:'bottomleft', imperial:false, maxWidth:200}).addTo(mymap);
			
			ctlMousePos = L.control.mousePosition({position:'bottomright'}).addTo(mymap);

			popBig = L.popup();
			popBig.setLatLng([-23.068675, -44.232645]);
			popBig.setContent("<h2>BIG</h2> <img src='img/big.jpg' width=300px>")
			
			mymap.on('contextmenu', function(e) {
				var dtCurrentTime = new Date();
			   L.marker(e.latlng).addTo(mymap).bindPopup(e.latlng.toString()+"<br>"+dtCurrentTime.toString()); 
			});
			
			mymap.on('keypress', function(e) {
			   if (e.originalEvent.key=='l') {
				   mymap.locate();
			   } 
			});
			
			mymap.on('locationfound', function(e) {
				console.log(e);
				if (mrkCurrentLocation) {
					mrkCurrentLocation.remove();
				}
				mrkCurrentLocation = L.circle(e.latlng,
					{radius:e.accuracy/2}).addTo(mymap);
				mymap.setView(e.latlng, 14);
			});
			
			mymap.on('locationerror', function(e) {
				console.log(e);
				alert("Location was not found")
			});
			
			mymap.on('zoomend', function() {
			   $('#zoom-level').html(mymap.getZoom()); 
			});
			
			mymap.on('moveend', function() {
			   $('#map-center').html(LatLngToArrayString(mymap.getCenter())); 
			});
			
			mymap.on('mousemove', function(e) {
			   $('#mouse-location').html(LatLngToArrayString(e.latlng)); 
			});
			
			$("#btnLocate").click(function() {
			   mymap.locate(); 
			});
			
			$("#btnBig").click(function() {
				mymap.setView([-23.068675, -44.232645], 14);
				mymap.openPopup(popBig);
			});
			
			function LatLngToArrayString(ll) {
				return "["+ll.lat.toFixed(5)+", "+ll.lng.toFixed(5)+"]";  
			} 
		});

	</script>

  </body>
</html>